<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>OBIXConfig Doctor</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
:root{
  --bg-light:#f4f6f8;
  --bg-dark:#0f1115;
  --card-light:#ffffff;
  --card-dark:#1a1d24;
  --text-light:#111;
  --text-dark:#eaeaea;
  --accent:#4caf50;
}

body{
  margin:0;
  font-family: system-ui, -apple-system, BlinkMacSystemFont;
  transition: background .3s,color .3s;
}

body.light{ background:var(--bg-light); color:var(--text-light);}
body.dark{ background:var(--bg-dark); color:var(--text-dark);}

.container{
  max-width:900px;
  margin:auto;
  padding:24px;
}

header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:24px;
}

.brand h1{
  margin:0;
  font-size:1.8rem;
}

.brand p{
  margin:4px 0 0;
  opacity:.7;
}

.toggle-theme{
  border:none;
  padding:8px 14px;
  border-radius:8px;
  cursor:pointer;
  background:#333;
  color:#fff;
}

.card{
  background:var(--card-light);
  border-radius:16px;
  padding:20px;
  margin-bottom:20px;
  box-shadow:0 10px 25px rgba(0,0,0,.08);
}

body.dark .card{ background:var(--card-dark);}

label{
  display:block;
  margin-top:14px;
  font-weight:600;
}

input,select{
  width:100%;
  padding:10px;
  border-radius:10px;
  border:1px solid #ccc;
  margin-top:6px;
}

button[type="submit"]{
  margin-top:20px;
  width:100%;
  padding:14px;
  border:none;
  border-radius:14px;
  background:var(--accent);
  color:#fff;
  font-size:1.1rem;
  cursor:pointer;
}

button.copy{
  margin-top:10px;
  padding:8px 12px;
  border-radius:8px;
  border:none;
  cursor:pointer;
}

pre{
  background:#111;
  color:#0f0;
  padding:14px;
  border-radius:12px;
  overflow:auto;
}

footer{
  text-align:center;
  opacity:.7;
  font-size:.9rem;
  margin:40px 0 10px;
}
</style>

<script>
function copyText(id){
  navigator.clipboard.writeText(document.getElementById(id).innerText);
  alert("‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢");
}
function toggleTheme(){
  document.body.classList.toggle('dark');
  document.body.classList.toggle('light');
  localStorage.setItem('theme',
    document.body.classList.contains('dark')?'dark':'light');
}
window.onload=()=>{
  document.body.classList.add(localStorage.getItem('theme')||'dark');
}
</script>
</head>

<body>
<div class="container">

<header>
  <div class="brand">
    <h1>üõ† OBIXConfig Doctor</h1>
    <p>FPV Drone ‚Ä¢ Betaflight Config Analyzer</p>
  </div>
  <button class="toggle-theme" onclick="toggleTheme()">üåó Theme</button>
</header>

<form method="POST" class="card">
  <label>‡∏Ç‡∏ô‡∏≤‡∏î‡πÇ‡∏î‡∏£‡∏ô (‡∏ô‡∏¥‡πâ‡∏ß)</label>
  <input name="size" required>

  <label>‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡πÇ‡∏î‡∏£‡∏ô (‡∏Å‡∏£‡∏±‡∏°)</label>
  <input name="weight" required>

  <label>‡πÅ‡∏ö‡∏ï‡πÄ‡∏ï‡∏≠‡∏£‡∏µ‡πà</label>
  <select name="battery">
    <option>4S</option><option>6S</option>
  </select>

  <label>‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏Å‡∏≤‡∏£‡∏ö‡∏¥‡∏ô</label>
  <select name="style">
    <option value="freestyle">Freestyle</option>
    <option value="longrange">Long Range</option>
    <option value="racing">Racing</option>
  </select>

  <label>‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏ö‡∏û‡∏±‡∏î</label>
  <input name="prop_size" value="5">

  <label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÉ‡∏ö</label>
  <select name="blades"><option>2</option><option selected>3</option></select>

  <label>Pitch</label>
  <input step="0.1" name="pitch" value="4.0">

  <button type="submit">üöÄ ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå</button>
</form>

{% if analysis %}
<div class="card">
<h2>üîç ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå</h2>
<p><b>{{ analysis.overview }}</b></p>

<h3>PID</h3>
<pre id="pid">
ROLL P {{analysis.pid.roll.p}} I {{analysis.pid.roll.i}} D {{analysis.pid.roll.d}}
PITCH P {{analysis.pid.pitch.p}} I {{analysis.pid.pitch.i}} D {{analysis.pid.pitch.d}}
YAW P {{analysis.pid.yaw.p}} I {{analysis.pid.yaw.i}}
</pre>
<button class="copy" onclick="copyText('pid')">Copy PID</button>

<h3>Filter</h3>
<pre id="filter">
Gyro LPF2 {{analysis.filter.gyro_lpf2}}
D-term LPF1 {{analysis.filter.dterm_lpf1}}
Dynamic Notch {{analysis.filter.dyn_notch}}
</pre>
<button class="copy" onclick="copyText('filter')">Copy Filter</button>
</div>
{% endif %}

<footer>
  <b>OBIXConfig Doctor</b> ‚Ä¢ Obixconfig Lab<br>
  Developed by real FPV pilots<br>
  ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏Å‡∏≤‡∏£‡∏à‡∏π‡∏ô‡πÇ‡∏î‡∏£‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏á‡πà‡∏≤‡∏¢ ‡∏™‡∏ô‡∏∏‡∏Å ‡πÅ‡∏•‡∏∞‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏•‡∏≠‡∏á‡∏ú‡∏¥‡∏î‡∏•‡∏≠‡∏á‡∏ñ‡∏π‡∏Å
</footer>

</div>
</body>
</html>
